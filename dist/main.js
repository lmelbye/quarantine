!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(2),a=r(3);function c(e,r,n){for(var i=[],a=0;a<t.count;a++){var c=0,o=0;if(a<n){var h=s();c=h.x*t.particleSpeed,o=h.y*t.particleSpeed}var u=Math.random()*(e-2*t.particleRadius)+t.particleRadius,l=Math.random()*(r-2*t.particleRadius)+t.particleRadius;i.push({size:t.particleRadius,speedx:c,speedy:o,x:u,y:l,health:a%100==0?{state:"sick",time:0}:{state:"healthy"}})}return{movement:{kind:"linear",particles:i},height:r,width:e,time:0}}function s(){var e=2*Math.random()-1,t=2*Math.random()-1,r=Math.sqrt(Math.pow(e,2)+Math.pow(t,2));return{x:e/r,y:t/r}}function o(e,r,n,i){for(var a=t.count/n,c=[],o=function(a){var o,h,u=s(),l=u.x*t.groupSpeed,d=u.y*t.groupSpeed,p=void 0,f=0;do{if(o=Math.random()*(e-2*i)+i,h=Math.random()*(r-2*i)+i,p=c.some((function(e){return Math.sqrt(Math.pow(e.centerx-o,2)+Math.pow(e.centery-h,2))<2*i+t.groupDistance})),++f>50)throw"Could not generate groups"}while(p);for(var m={centerx:o,centery:h,speedx:l,speedy:d,radius:i,particles:[]},y=0;y<n;y++){var v=Math.random()*i*2-i+o,x=Math.random()*i*2-i+h,g=s(),w=g.x*t.groupParticleSpeed,M=g.y*t.groupParticleSpeed;m.particles.push({size:t.particleRadius,speedx:w,speedy:M,x:v,y:x,health:((a+1)*n+y)%100==0?{state:"sick",time:0}:{state:"healthy"}})}c.push(m)},h=0;h<a;h++)o(h);return{movement:{kind:"groups",groups:c},height:r,width:e,time:0}}t.cureTime=10,t.count=300,t.particleRadius=3,t.particleSpeed=80,t.groupSpeed=50,t.groupDistance=-1,t.groupParticleSpeed=30,t.length=60,window.onload=function(){var e=document.getElementById("world"),r=document.getElementById("chart");if(null==e||null==r)throw"Canvas not found";var s,h=new a.Chart(r),u=new n.Draw(e),l=document.getElementById("movement");if(!l)throw"Select not found";function d(r){switch(r){case"all":s=c(e.width,e.height,t.count);break;case"p50":s=c(e.width,e.height,.5*t.count);break;case"p10":s=c(e.width,e.height,.1*t.count);break;case"p5":s=c(e.width,e.height,.05*t.count);break;case"g10":s=o(e.width,e.height,10,20);break;case"g5":s=o(e.width,e.height,5,10);break;case"g2":s=o(e.width,e.height,2,6)}h.clear(),u.world(s),h.push(s),h.draw()}d(l.value),l.addEventListener("change",(function(e){d(e.currentTarget.value)}));var p,f=function(e){s=i.step(s,e),u.world(s),h.push(s),h.draw()};window.stepSim=f,window.play=function(){d(l.value),p&&clearInterval(p),p=setInterval((function(){f(1/60),s.time>t.length&&clearInterval(p)}),1/60*1e3)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=e.getContext("2d");if(null===t)throw"Could not initialize canvas";this.ctx=t,this.canvas=e}return e.prototype.particle=function(e){this.ctx.beginPath(),this.ctx.arc(e.x,e.y,e.size,0,2*Math.PI),this.ctx.fillStyle=this.color(e),this.ctx.fill()},e.prototype.color=function(e){switch(e.health.state){case"sick":return"#ff0000";case"cured":return"#ffff00";case"healthy":return"#00ff"}},e.prototype.world=function(e){var t=this;switch(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),e.movement.kind){case"linear":return e.movement.particles.forEach(this.particle,this),!0;case"groups":return e.movement.groups.forEach((function(e){return e.particles.forEach(t.particle,t)})),!0}},e}();t.Draw=n},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0);function a(e,t,r){switch(r.health.state){case"healthy":return e.some((function(e){return e!=r&&"sick"==e.health.state&&function(e,t){var r=e.size+t.size,n=e.x-t.x,i=e.y-t.y;return r>Math.sqrt(n*n+i*i)}(r,e)}))?{state:"sick",time:t}:r.health;case"sick":return t>r.health.time+i.cureTime?{state:"cured"}:r.health;case"cured":return r.health}}function c(e,t,r,n){return Math.sqrt(Math.pow(e-t,2)+Math.pow(r-n,2))}function s(e,t,r,n){if("linear"==e.movement.kind)throw"error";return e.movement.groups.filter((function(e){return t!==e})).find((function(e){return c(e.centerx,r,e.centery,n)<2*e.radius+i.groupDistance}))}t.step=function(e,t){var r;switch(e.movement.kind){case"linear":var i=e.movement.particles.map((function(r){return function(e,t,r){var i=r.x+r.speedx*e,a=r.y+r.speedy*e,c=i+r.size>t.width||i<0?-1*r.speedx:r.speedx,s=a+r.size>t.height||a<0?-1*r.speedy:r.speedy;return n(n({},r),{speedx:c,speedy:s,x:i,y:a})}(t,e,r)})),o=i.map((function(t){return n(n({},t),{health:a(i,e.time,t)})}));e.movement={kind:"linear",particles:o};break;case"groups":e.movement.groups=e.movement.groups.map((function(r){return function(e,t,r){if("linear"==t.movement.kind)throw"must be group";var n,i,a,o,h,u,l,d=0;do{n=r.speedx*e,i=r.speedy*e,a=r.centerx+n,o=r.centery+i,h=s(t,r,a,o),u=a+r.radius>t.width||a-r.radius<0,l=o+r.radius>t.height||o-r.radius<0,h?(r.speedx*=-1,r.speedy*=-1):(u&&(r.speedx*=-1),l&&(r.speedy*=-1)),d++}while(d<20&&(h||u||l));return r.centerx=a,r.centery=o,r.centerx=Math.max(r.radius,r.centerx),r.centerx=Math.min(t.width-r.radius,r.centerx),r.centery=Math.max(r.radius,r.centery),r.centery=Math.min(t.height-r.radius,r.centery),r.particles.map((function(e){return e.x+=n,e.y+=i,e})).forEach((function(t){t.x=t.x+t.speedx*e,t.y=t.y+t.speedy*e;var n=c(t.x,r.centerx,t.y,r.centery);if(n>r.radius){var i=(t.x-r.centerx)/n,a=(t.y-r.centery)/n,s=-a,o=i,h=-(i*t.speedx+a*t.speedy),u=s*t.speedx+o*t.speedy;t.speedx=h*i+u*s,t.speedy=h*a+u*o}})),r}(t,e,r)}));var h=(r=[]).concat.apply(r,e.movement.groups.map((function(e){return e.particles})));e.movement.groups.forEach((function(t){t.particles.forEach((function(t){t.health=a(h,e.time,t)}))}))}return e.time+=t,e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.points=[],this.currentMax=0,this.cured=document.getElementById("cured"),this.healthy=document.getElementById("healthy"),this.sick=document.getElementById("sick"),this.total=document.getElementById("total"),this.maxSick=document.getElementById("maxsick");var t=e.getContext("2d");if(null===t)throw"Could not initialize canvas";this.ctx=t,this.canvas=e}return e.prototype.clear=function(){this.points=[],this.currentMax=0,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.push=function(e){var t,r;switch(e.movement.kind){case"linear":r=e.movement.particles;break;case"groups":r=(t=[]).concat.apply(t,e.movement.groups.map((function(e){return e.particles})))}var n=r.filter((function(e){return"sick"==e.health.state})).length,i=r.filter((function(e){return"cured"==e.health.state})).length,a=r.filter((function(e){return"healthy"==e.health.state})).length;this.points.push({sick:n,cured:i,healthy:a,time:e.time}),this.currentMax=Math.max(this.currentMax,n),this.healthy&&this.maxSick&&this.cured&&this.total&&this.sick&&(this.healthy.innerHTML=""+a,this.cured.innerHTML=""+i,this.maxSick.innerHTML=""+this.currentMax,this.sick.innerHTML=""+n,this.total.innerHTML=""+r.length)},e.prototype.draw=function(){var e=this;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#f00",this.ctx.beginPath();var t=0,r=this.canvas.height;this.ctx.moveTo(t,r),this.points.forEach((function(n){r=e.canvas.height-n.sick,t=10*n.time,e.ctx.lineTo(t,r)})),this.ctx.lineTo(t,this.canvas.height),this.ctx.closePath(),this.ctx.fill()},e}();t.Chart=n}]);